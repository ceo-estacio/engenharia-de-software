

<!DOCTYPE html>
<html lang="pt-br">
   <head>
      <title></title>

      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" href="../src/styles/globals.css">
      <script src="../src/Widgets/AppBar.js" defer></script>
      <style>
      </style>
   </head>
   <body>
      <appbar></appbar>
      
      <main>
         <h2>Tema 7: Integração do Php Com Banco de Dados</h2>

         <modulo n="1" dm="">
            <h4>Módulo 1</h4>
            <h2>A Classe PDO em banco de dados</h2>

            <h4>conexão com mysql</h4>
            <code>
&lt;?php
   $conn = myswli_connect(
      HOST,
      USER,
      PASSWORD,
      DBNAME
   );
   
   $instrucaoSQL = "Select nome, cpf, telefone From Cliente";

   $stmt = mysqli_prepare(
      $conn,
      $instrucaoSQL
   );

   mysqli_stmt_bind_result(
      $stmt,
      $nome,
      $cpf,
      $tel
   );

   mysqli_stmt_execute(
      $stmt
   );
   
   while( mysqli_stmt_fetch( $stmt ) ) {
      echo $nome . "&lt;br /&gt;";
   }

   mysqli_close( $conn );
?&gt;
            </code>

            <h4>conexão com postgreSQL</h4>
            <code>
&lt;?php
   $connection = pg_connect( $stringConnection );
   $instrucaoSQL = "Select nome, cpf, telefone, From Cliente";
   $result = pg_query(
      $connection,
      $instrucaoSQL
   );

   while( $row = pg_fetch_array( $result ) ) {
      echo $row[ "nome" ] . "&lt;br /&lt;";
   }

   pg_close( $connection );
?&lt;
            </code>

            <h4>PDO ( PFP Data Objects ) </h4>
            <code>
&lt;?php
   define ( "HOST", "127.0.0.1" );
   define ( "PORT", "5432" );
   define ( "DBNAME", "test" );
   define ( "USER", "user" );
   define ( "PASSWORD", "psswd" );

   try {
      $dsn = new PDO( "myswl:host=". HOST . 
                      ";port=".PORT.";dbname=" . DBNAME . 
                      ";password=" . PASSWORD );
   } catch( PDOException $e ) {
      echo "A conexão falhou : " . $e->getMessage();
   }

   $dsn = null;
?&lt;
            </code>

            <h4>Classes no PHP</h4>
            <code>
&lt;?php
   class Pessoa {
      var $nome;
      var $idade;

      public function __construct() {
      }
      
      public function setNome( $nome ) {
         $this->nome = $nome;
      }

      public function getIdade() {
         return $this->idade;
      }
   }

   var $p1 = new Pessoa();

   $p1->setNome( "Ana" );
?&lt;
            </code>

            <h4>DML ( Data Manipulation Language )</h4>
            <code>
&lt;?php
   $qtdDeLinhasAfetadas = $dsn->exec(
      "Delete From Cliente Where codigo_cliente = 1"
   );
?&lt;
            </code>

            <h4>consulta ( query )</h4>
            <code>
&lt;?php
   $instrucaoSQL = "Select nome, cpf, telefone From Cliente";

   $resultSet = $dsn->query( $sql );

   while( $row = $resultSet->fetch() ) {
      echo $row[ "nome" ] . "\n\t";
      echo $row[ "cpf" ] . "\n\t";
      echo $row[ "telefone" ] . "\n\t";
   }
?&lt;
            </code>

            <h4>proteção contra injection</h4>
            <code>
&lt;?php
   $login = #_POST[ "login" ];
   $pswd = $_POST[ "pswd" ];
   $stmt = $dsn->prepare(
      "Select * From Usuario "."Where login = :login And password = :password"
   );

   $stmt->execute(
      [
         ":login" => $login,
         ":password" => $pswd
      ]
   );

   /* Aqui entraria a lógica com $_SESSION... */

   $stmt = null;
   $dsn = null;
?&lt;
            </code>

            <h4>Conexão com MySQL</h4>
            <code>
&lt;?php

   //Constantes para armazenamento das variáveis de conexão.
   define('HOST', '127.0.0.1');
   define('DBNAME', 'test');
   define('USER', 'user');
   define('PASSWORD', 'psswd');
   
   //Conectando com o Servidor
   $conn = mysqli_connect(HOST, USER, PASSWORD, DBNAME) or die( ' Não foi possível conectar.' );
   
   //Realizando uma consulta no BD
   $instrucaoSQL = "Select nome, cpf, telefone From Cliente";
   $stmt = mysqli_prepare($conn, $instrucaoSQL);
   mysqli_stmt_bind_result($stmt, $nome, $cpf, $tel);
   mysqli_stmt_execute($stmt);
   
   while (mysqli_stmt_fetch($stmt)) {
      echo $nome . "\t";
      echo $cpf . "\t";
      echo $tel . "\n";
   }
   
   //Encerrando a conexão
   mysqli_close($conn);
?&gt;
            </code>
         </modulo>

         <h4>Conexão com PostegreSQL</h4>
         <code>
&lt;?php
   //Constantes para armazenamento das variáveis de conexão.
   define('HOST', '127.0.0.1');
   define('DBNAME', 'test');
   define('USER', 'user');
   define('PASSWORD', 'psswd');

   //Conectando com o Banco de dados
   $stringConn = "host=".HOST." dbname=".DBNAME." user=".USER." password=".PASSWORD;
   $conn = pg_connect($stringConn) or die( ' Ocorreu um erro e não foi possível conectar ao banco de dados.' );

   //Realizando uma consulta no BD
   $instrucaoSQL = "Select nome, cpf, telefone From Cliente";
   $result = pg_query( $conn, $instrucaoSQL ) or die(' Ocorreu um erro na execução da instrução: ' . $instrucaoSQL );

   //pg_query($dbcon, "SELECT id, nome FROM clientes");

   //Imprimindo os dados da consulta
   while ($row = pg_fetch_array( $result )){
      echo $row['nome'] . "\t";
      echo $row['cpf'] . "\t";
      echo $row['telefone'] . "\n";
   }

   //Encerrando a conexão
   pg_close($conn);
?&gt;
         </code>
         
         <modulo n="2" dm="">
            <h4>Módulo 2</h4>
            <h2>Métodos da Classe PDO</h2>
         </modulo>
         
         <modulo n="3" dm="">
            <h4>Módulo 3</h4>
            <h2>Construir uma aplicação com banco de dados</h2>
         </modulo>
         
         &#9776;
      </main>
      
      <script type="module">
         // import AppBar from "../../Components/AppBar.js";

         
         AppBar();
      </script>
   </body>
</html>

